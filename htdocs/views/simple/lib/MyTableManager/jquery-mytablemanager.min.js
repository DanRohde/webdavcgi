(function(e){function t(t,n,r,i,s,o){var u=t.find("tbody tr").get();u.sort(function(t,u){var a=0,f=e(t),l=e(u),c=f.attr(r)?n=="number"?parseInt(f.attr(r),10):f.attr(r):t.cells.item(s).innerHTML.toLowerCase(),h=l.attr(r)?n=="number"?parseInt(l.attr(r),10):l.attr(r):u.cells.item(s).innerHTML.toLowerCase();return f.attr("data-file").match(/^\.\.?$/)?-1:l.attr("data-file").match(/^\.\.?$/)?1:f.attr("data-type")=="dir"&&l.attr("data-type")!="dir"?-1:f.attr("data-type")!="dir"&&l.attr("data-type")=="dir"?1:(n=="number"?a=c-h:c.localeCompare?a=c.localeCompare(h):a=c<h?-1:c==h?0:1,a===0&&r!=o&&(c.localeCompare?a=f.attr(o).localeCompare(l.attr(o)):a=f.attr(o)<l.attr(o)?-1:f.attr(o)>l.attr(o)?1:0),i*a)});for(var a=0;a<u.length;a++)t.append(u[a]);return t}function n(t){e.MyCookie("visibletablecolumns",t.find("th[data-name]:visible").map(function(){return e(this).data("name")}).get().join(","),1),e("body").trigger("settingchanged",{setting:"visibletablecolumns",value:e.MyCookie("visibletablecolumns")})}e.fn.MyTableManager=function(){function o(r,i){var s=i.draggable.prop("cellIndex"),o=e(this).prop("cellIndex");if(s+1==o)return!1;var u=t.find("thead th");return u.eq(s).detach().insertBefore(u.eq(o)),e("#fileList tr").each(function(){var t=e(this).children("td");t.eq(s).detach().insertBefore(t.eq(o))}),n(t),!0}var t=this;t.find("th.dragaccept").draggable({zIndex:200,scope:"fileListTable",axis:"x",helper:function(t){var n=e(t.currentTarget);return e(t.currentTarget).clone().width(n.width()).addClass("dragged")}}),t.find("th.dragaccept, th.dropaccept").droppable({scope:"fileListTable",tolerance:"pointer",drop:o,hoverClass:"draghover"});var r=e.MyTableManager.getLastTableSort();r&&e.MyTableManager.sortTable(t,r.name,r.sortorder),t.find("th:not(.sorter-false)").addClass("tablesorter-head").off("click.tablecolumnmanager").on("click.tablecolumnmanager",function(n){if(n.target!=this)return;var r=this;r.MyClickCounter===undefined?(r.MyClickCounter=1,window.setTimeout(function(){if(r.MyClickCounter==1){var n=e.MyTableManager.getLastTableSort();e.MyTableManager.sortTable(t,e(r).data("name"),n.name==e(r).data("name")?-n.sortorder:1)}delete r.MyClickCounter},250)):r.MyClickCounter+=1});var i=e("<div/>").addClass("columnResizeHandle left"),s=e("<div/>").addClass("columnResizeHandle right");return t.find("th:not(.resizable-false)").each(function(){var t=e(this);t.prepend(i.clone(),s.clone()),e.MyTableManager.setTableColumnWidth(t,e.MyCookie(t.prop("id")+".width"))}).off("dblclick.tablecolumnmanager").on("dblclick.tablecolumnmanager",function(t){if(t.target!=this)return;var n=e(this);e.MyTableManager.setTableColumnWidth(n,n.width()==n.data("origWidth")?"minimum":"default")}),t.find(".columnResizeHandle").draggable({scope:"columnResize",axis:"x",start:function(t,n){var r=e(this),i=r.closest("th");this.MTCMColumnResize={startPos:parseInt(n.offset.left,10),column:i,startWidth:i.width(),handlePos:r.hasClass("left")?"left":"right"}},stop:function(){var t=e(this),n=this.MTCMColumnResize;t.removeAttr("style"),e.MyTableManager.setTableColumnWidth(n.column,n.column.width())},drag:function(e,t){var n=this.MTCMColumnResize;n.handlePos=="right"?n.column.width(n.startWidth+t.offset.left-n.startPos):n.column.width(n.startWidth+n.startPos-t.offset.left)}}),this},e.MyTableManager={setTableColumnWidth:function(t,n){var r=t.prop("id")+".width",i=n,s=t.data("origWidth");return s===undefined&&t.data("origWidth",t.width()),i===undefined?(t.addClass("column-width-default"),t):(i==="default"?i=s:i==="minimum"&&(i=1),t.width(i),t.toggleClass("column-width-default",i==s).toggleClass("column-width-minimum",i==1),e.MyCookie.toggleCookie(r,i,i!=s),t)},toggleTableColumn:function(e,t,r){var i=e.find("th[data-name="+t+"]"),s=r===undefined?!i.is(":visible"):r,o=i.toggleClass("hidden",!s).toggle(s).prop("cellIndex");e.find("td:nth-child("+(o+1)+")").toggleClass("hidden",!s).toggle(s),n(e)},getLastTableSort:function(){var t=e.MyCookie("order").split("_");return t?{name:t[0],sortorder:t[1]&&t[1]=="desc"?-1:1}:{name:"data-file",sortorder:1}},sortTable:function(n,r,i){var s=n.find("th[data-name='"+r+"']:not(.sorter-false)");if(s.length==0)return;n.find("th").removeClass("tablesorter-down tablesorter-up"),s.addClass(i==1?"tablesorter-up":"tablesorter-down"),t(n,s.data("sorttype")||"string",s.data("sort"),i,s.prop("cellIndex"),"data-file"),e.MyCookie("order",r+(i==1?"_asc":"_desc"),1),e("body").trigger("settingchanged",{setting:"order",value:e.MyCookie("order")})}}})(jQuery);
