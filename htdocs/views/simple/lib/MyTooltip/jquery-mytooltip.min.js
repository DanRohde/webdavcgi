(function(a){a.fn.MyTooltip=function(d){var q=a.extend({delay:500,showtimeout:3000,showhelptimeout:7000,hidetimeout:0,hidehelptimeout:3000,helphandler:g},typeof d=="number"?{delay:d}:d);var n=a("body");var l=a(window);var f,i,k;if(!n.data("tooltip")){i=a("<div/>").addClass("tooltip-content");k=a("<div/>").addClass("tooltip-ta");f=a("<div/>").addClass("tooltip").append(i,[a("<div/>").addClass("tooltip-help").attr({tabindex:1}).on("click",function(t){q.helphandler.call(f.data("element"),f.data("help"))}).MyKeyboardEventHandler(),k]).appendTo(a("body")).hide().on("mouseenter mousemove focus",function(t){if(f.data("help")!=undefined){c()}else{h(q.hidetimeout)}}).on("mouseleave blur",function(t){h(q.showtimeout)});n.data("tooltip",f)}else{f=n.data("tooltip");i=a(".tooltip-content",f);k=a(".tooltip-ta",f)}p(this.find("[title]"));if(this.attr("title")){p(this)}function g(t){a("<div/>").append(a("<iframe/>").attr({name:"help",src:t,width:"99%",height:"99%"}).text(t)).dialog({width:l.width()/2,height:l.height()/2,title:a("#help").text(),dialogClass:"helpdialog"})}function j(t){if(t.preventDefault){t.preventDefault()}else{t.returnValue=false}if(t.stopPropagation){t.stopPropagation()}}function m(x,u){var t=x.type=="focus";var z=t?u.offset().left+u.outerWidth()-15:x.pageX;var y=t?u.offset().top+u.outerHeight()+10:x.pageY+20;var w=Math.max(Math.floor(l.width()/2),50);var v=Math.max(Math.floor(l.height()/2),10);f.removeClass("tooltip-left tooltip-right tooltip-top tooltip-bottom");if(z+f.outerWidth()>l.width()){z=(t?u.offset().left:x.pageX)-f.outerWidth()-Math.min(u.outerWidth(),15);f.addClass("tooltip-right")}else{f.addClass("tooltip-left")}if(y+f.outerHeight()>l.height()){y=(t?u.offset().top:x.pageY)-f.outerHeight();f.addClass("tooltip-top")}else{f.addClass("tooltip-bottom")}return f.css({left:z+"px",top:y+"px","max-height":v+"px","max-width":w+"px"})}function c(){window.clearTimeout(n.data("tttimeout"))}function h(u){c();if(u==0){f.hide()}else{n.data("tttimeout",window.setTimeout(function(){f.hide()},u))}}function r(t){var u=t.attr("title");if(!u){u=t.attr("data-tooltip")}if(!u){u=""}return t.attr("data-tooltip",u).removeAttr("title")}function e(v,u){c();f.hide();r(u);if(u.data("htmltooltip")){i.html(u.data("htmltooltip"))}else{i.text(u.attr("data-tooltip"))}if(i.text()==""){return}var t=u.data("help");if(!t){t=u.parents("[data-help]:first").data("help")}f.toggleClass("help",t!=undefined).data("help",t);f.data("element",u);if(q.delay>0){n.data("tttimeout",window.setTimeout(function(){m(v,u).show();h(q.showtimeout)},q.delay))}else{m(v,u).show();h(q.showtimeout)}}function s(t){if(this!=t.target){return}e(t,a(this))}function o(t){if(this!=t.target){return}if(f.is(":visible")&&f.data("help")!=undefined){h(q.showhelptimeout)}else{if(f.is(":visible")&&q.delay==0){m(t,a(this))}else{e(t,a(this))}}}function b(t){if(this!=t.target){return}if(f.is(":visible")&&f.data("help")!=undefined){h(q.hidehelptimeout)}else{h(q.hidetimeout)}}function p(t){t.off(".tooltip").on("mouseenter.tooltip focus.tooltip",s).on("mouseleave.tooltip blur.tooltip",b).on("mousemove.tooltip",o)}return this}}(jQuery));