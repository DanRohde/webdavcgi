(function(e){function t(e){e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation()}function n(n){var i=n.actionTarget,u=r(n),a=typeof n.defaultValue=="function"?n.defaultValue.call(i):n.defaultValue,f=e("<input/>").addClass(n.inputClass).on("click",function(n){t(n),e(this).focus()}).off("dblclick").on("dblclick",t);return n.spellcheck&&f.prop("spellcheck",1),n.lang!=null&&f.attr("lang",n.lang),a&&f.val(a),f.keydown(function(r){if(r.keyCode==13||n.allowtab&&r.keyCode==9){t(r);var f=e(this).val();u.data("input-finished",!0),s(n).closest(":focusable").focus(),n.checkAllowedValue(f,a)?(o(n.changeEvent,i,{value:f}),o(n.finalEvent,i,!0)):(o(n.cancelEvent,i),o(n.finalEvent,i,!1))}else r.keyCode==27&&(t(r),u.data("input-canceled",!0),s(n).closest(":focusable").focus(),o(n.cancelEvent,i),o(n.finalEvent,i))}).focusout(function(){s(n),o(n.cancelEvent,i),o(n.finalEvent,i,!1)})}function r(e){return e.editorTarget===null?e.actionTarget:typeof e.editorTarget=="function"?e.editorTarget.call(e.actionTarget):e.editorTarget}function i(t){var i=r(t);return t.actionInterceptor!==null&&t.actionInterceptor.call(t.actionTarget)?i:(i.wrapInner(e("<div/>").addClass(t.wrapperClass).hide()),o(t.beforeEvent,t.actionTarget),i.prepend(n(t)).find(":focusable").focus().select())}function s(e){var t=r(e);t.find("."+e.inputClass).remove();var n=t.find("."+e.wrapperClass);return n.children().length==0?n.replaceWith(n.html()):n.children().unwrap("."+e.wrapperClass),t}function o(e,t,n){e&&e.call(t,n)}e.fn.MyInplaceEditor=function(t){var n=e.extend({},e.fn.MyInplaceEditor.settings,t,{actionTarget:this});return n.actionTarget.off("click.myinplaceeditor").on("click.myinplaceeditor",function(t){n.actionTarget=e(t.currentTarget),i(n)}),this},e.MyInplaceEditor=function(t){return i(e.extend({},e.fn.MyInplaceEditor.settings,t,{actionTarget:{}}))},e.fn.MyInplaceEditor.checkAllowedValue=function(e,t){return e!==""&&(!t||t!=e)},e.fn.MyInplaceEditor.settings={actionInterceptor:null,editorTarget:null,defaultValue:null,checkAllowedValue:e.fn.MyInplaceEditor.checkAllowedValue,beforeEvent:null,changeEvent:null,cancelEvent:null,finalEvent:null,inputClass:"myinplaceeditor-input",wrapperClass:"myinplaceeditor-hidden",spellcheck:!1,lang:null,allowtab:!1}})(jQuery);
