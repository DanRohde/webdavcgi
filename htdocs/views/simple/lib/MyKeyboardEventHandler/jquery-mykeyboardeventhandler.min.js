(function(e){e.fn.MyKeyboardEventHandler=function(t){function r(e){e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation()}function i(t){if(t.target!=this)return;r(t);var n=e(this),i;switch(t.keyCode){case 32:case 13:if(n.data("input-finished")){n.removeData("input-finished");return}n.trigger("click",{origEvent:t});break;case 27:if(n.data("input-canceled")){n.removeData("input-canceled");return}n.closest(".dropdown-menu").hide(),n.closest("ul.popup:visible").hide(),e("ul.popup:visible",n).hide(),n.closest(":focusable").focus();break;case 34:case 35:n.nextAll(":not([tabindex=-1]):focusable:last").focus();break;case 33:case 36:n.prevAll(":not([tabindex=-1]):focusable:last").focus();break;case 37:(i=n.prevAll(":not([tabindex=-1]):focusable")).length>0?i.first().focus():n.parents(":focusable").prevAll(":not([tabindex=-1]):focusable:first").focus();break;case 38:(i=n.prevAll(":not([tabindex=-1]):focusable")).length>0?i.first().focus():n.parents(":not([tabindex=-1]):focusable").first().focus();break;case 39:(i=n.nextAll(":not([tabindex=-1]):focusable")).length>0?i.first().focus():n.parents(":focusable").nextAll(":not([tabindex=-1]):focusable:first").focus();break;case 40:(i=e(":not([tabindex=-1]):focusable",n)).length>0?i.first().focus():n.nextAll(":not([tabindex=-1]):focusable:first").focus()}}var n=e.extend({namespace:"mykeyboardeventhandler"},t);return this.off("keyup."+n.namespace).on("keyup."+n.namespace,i),this}})(jQuery);
