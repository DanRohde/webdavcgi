$(document).ready(function(){$("body").on("fileActionEvent",function(c,d){if(d.obj.hasClass("afsaclmanager")){a.call(this,c)}});$(".action.afsaclmanager").click(a);function a(e){ToolBox.preventDefault(e);if($(this).hasClass("disabled")){return false}var c=this;$(".action.afsaclmanager").addClass("disabled");var g=$("#fileList").attr("data-uri");var f=$("#fileList tr.selected[data-type='dir']");var d=$(this).attr("data-template");if(f.length>0){g=ToolBox.concatUri(g,encodeURIComponent(ToolBox.stripSlash($(f[0]).attr("data-file")))+"/")}$.get(g,{ajax:"getAFSACLManager",template:d},function(h){var i=$(h);b(i);("#afasaclmanager",i).submit(function(){$("input[type='submit']",i).attr("disabled","disable");var k=ToolBox.blockPage();var j=$.post(g,$("#afsaclmanager",i).serialize(),function(l){ToolBox.handleJSONResponse(l);k.remove();$.get(g,{ajax:"getAFSACLManager",template:d},function(m){i.html($(m).unwrap());b(i)})});ToolBox.renderAbortDialog(j);return false});i.dialog({modal:true,width:"auto",height:"auto",dialogClass:"afsaclmanager",closeText:$("#close").html(),close:function(){$(".action.afsaclmanager").removeClass("disabled");i.remove()}}).show()})}function b(c){$("input[readonly='readonly']",c).click(function(d){preventDefault(d)});$("input.afsaclmanager.add",c).autocomplete({minLength:4,source:function(e,d){$.get($("#fileList").data("uri"),{ajax:"searchAFSUserOrGroupEntry",term:e.term},function(f){d(f.result?f.result:new Array())})}});$("input[name=saveafsacl]",c).button()}});