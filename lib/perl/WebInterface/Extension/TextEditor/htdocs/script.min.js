$(document).ready(function(){$("body").on("fileActionEvent",function(c,d){if(d.obj.hasClass("edit")){a(d.row)}});function b(f,e){e.trigger("editsubmit");var d=ToolBox.blockPage();var c=$.post(ToolBox.addMissingSlash($("#fileList").attr("data-uri")),{action:"savetextdata",filename:f.attr("data-file"),textdata:e.val()},function(g){if(!g.error&&g.message){e.data("response",e.val());var h=$.get(ToolBox.addMissingSlash($("#fileList").attr("data-uri")),{ajax:"getFileListEntry",template:$("#fileList").attr("data-entrytemplate"),file:f.attr("data-file")},function(i){var j=$(i);f.replaceWith(j);f=j;ToolBox.initFileList();d.remove()});ToolBox.renderAbortDialog(h)}ToolBox.handleJSONResponse(g)});ToolBox.renderAbortDialog(c)}function a(e){var d=ToolBox.blockPage();var c=$.get($("#fileList").attr("data-uri"),{action:"edit",filename:e.attr("data-file")},function(f){d.remove();if(f.message||f.error){ToolBox.handleJSONResponse(f)}else{var g=$(f);var h=$(".textdata",g);h.data("response",h.val());g.find(".action.savetextdata").button().off("click").click(function(i){ToolBox.preventDefault(i);if(ToolBox.cookie("settings.confirm.save")!="no"){ToolBox.confirmDialog($("#confirmsavetextdata").html().replace(/%s/,e.attr("data-file")),{confirm:function(){b(e,h)},setting:"settings.confirm.save"})}else{b(e,h)}});g.find(".action.cancel-edit").button().off("click").click(function(i){ToolBox.preventDefault(i);h.trigger("editsubmit");g.dialog("close")});g.dialog({modal:true,width:"auto",height:"auto",title:e.attr("data-file"),open:function(){h.trigger("editstart")},close:function(i){h.trigger("editdone")},beforeClose:function(i,j){return h.val()==h.data("response")||window.confirm($("#canceledit").html())}})}});ToolBox.renderAbortDialog(c)}});