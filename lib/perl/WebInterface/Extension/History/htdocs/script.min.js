$(document).ready(function(){function t(e){return e.length>0?$.MyCookie("history",JSON.stringify(e),1):$.MyCookie.rmCookies("history"),e}function n(){return $.MyCookie("history")?JSON.parse($.MyCookie("history")):[]}function r(e){var t=$(".history-popup-history");t.find("li.action.changeUri").remove();var n=$("#fileList").data("uri");for(var r=0;r<e.length;r++){var i=decodeURIComponent(e[r]),s=i;i.length>34&&(i="/..."+s.substr(-30));var o=$("<li/>").addClass("action changeUri history suffix-folder").css({"padding-left":"26px"}).attr({title:s,tabindex:0}).data("uri",e[r]).html(ToolBox.quoteWhiteSpaces(i)).prepend($("<div>").css({marginLeft:"-26px",display:"inline-block",verticalAlign:"bottom",minWidth:"22px",backgroundSize:"18px 18px"}).addClass("icon category-folder"));e[r]==n&&o.addClass("disabled"),t.prepend(o)}return t.find(".action.changeUri:not(.disabled)").click(function(){ToolBox.changeUri($(this).data("uri"))}).MyKeyboardEventHandler(),t.MyTooltip(250),e}var e=$("body");$("#flt").on("fileListChanged",function(){var t=n()||[],r=$("#fileList").data("uri")||window.location.pathname,i=-1;(i=t.indexOf(r))>-1&&t.splice(i,1),t.length>=10&&t.shift(),t.push(r),e.trigger("history.changed",{history:t})}),e.on("history.changed",function(e,n){r(t(n.history)),$(".action.history-clear").toggleClass("disabled",n.history&&n.history.length==0)}),$(".action.history-clear").click(function(){$(this).hasClass("disabled")||e.trigger("history.changed",{history:[]})})});
