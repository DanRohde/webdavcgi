$(document).ready(function(){var a=$("body");$("#flt").on("fileListChanged",function(){var g=a.data("history")||b()||new Array();var f=$("#fileList").data("uri")||window.location.pathname;var e=-1;if((e=g.indexOf(f))>-1){g.splice(e,1)}if(g.length>=10){g.shift()}g.push(f);a.data("history",g);a.trigger("history.changed",{history:g})});a.on("history.changed",function(f,g){d(g.history);c(g.history);$(".action.history-clear").toggle(g.history&&g.history.length>0)});$(".action.history-clear").click(function(){ToolBox.rmcookies("history");a.trigger("history.changed",{history:new Array()})});function d(e){if(e.length>0){ToolBox.cookie("history",JSON.stringify(e),1)}}function b(){return ToolBox.cookie("history")?$.parseJSON(ToolBox.cookie("history")):new Array()}function c(l){var k=$(".history-popup .subpopupmenu");k.find("li.action.changeUri").remove();var e=$("#fileList").data("uri");for(var h=0;h<l.length;h++){var g=decodeURIComponent(l[h]);var f=g;if(g.length>34){g="/..."+f.substr(-30)}var j=$("<li/>").addClass("action changeUri history icon category-folder suffix-folder").attr("title",f).data("uri",l[h]).html(g);if(l[h]==e){j.addClass("disabled")}k.prepend(j)}k.find(".action.changeUri:not(.disabled)").click(function(){ToolBox.changeUri($(this).data("uri"))});k.MyTooltip(250)}});