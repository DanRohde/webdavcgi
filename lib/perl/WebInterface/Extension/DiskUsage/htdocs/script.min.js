$(document).ready(function(){$("body").on("fileActionEvent",function(f,g){if(g.obj.hasClass("diskusage")){c(ToolBox.getSelectedFiles(g.obj))}});function b(){var f=$("#fileListTable");$("#apps .action.diskusage").toggleClass("disabled",f.hasClass("unselectable-yes")||f.hasClass("isreadable-no"))}$("#flt").on("fileListChanged",b);b();function c(f){$(".action.diskusage").addClass("disabled");var h=ToolBox.blockPage();var g=$.post($("#fileList").attr("data-uri"),{action:"diskusage",file:f},function(i){$(".action.diskusage").removeClass("disabled");h.remove();ToolBox.removeAbortDialog();if(i.error){ToolBox.handleJSONResponse(i);return}var j=$(i);var k=function(l){window.location.href=$("a",$(this)).attr("href")};$("tr.diskusage.entry",j).dblclick(k).click(k);j.dialog({modal:true,width:"auto",height:"auto",maxWidth:$(window).width()-100,resizable:true,closeText:$("#close").html(),dialogClass:"diskusage",open:function(){a(j);d(j);e(j)},close:function(){j.dialog("destroy")}});j.MyTooltip(250)});ToolBox.renderAbortDialog(g,2500,function(){$(".action.diskusage").removeClass("disabled")})}function e(f){$(".accordion",f).accordion({collapsible:true,active:false,heightStyle:"content",activate:function(h,g){$(this).trigger("MyActivate",[h,g])}})}function a(g){var f=new Array();f.color1=[{val:0,color:"#aa0000"},{val:0.2,color:"#00aaaa"},{val:0.4,color:"#aaaa00"},{val:0.6,color:"#00aa00"},{val:0.8,color:"#0000aa"},{val:1,color:"#000000"}];f.color2=[{val:0,color:"#404040"},{val:0.2,color:"#909090"},{val:0.4,color:"#333333"},{val:0.6,color:"#404040"},{val:0.8,color:"#989898"},{val:1,color:"#000000"}];f.color3=[{val:0,color:"#000040"},{val:0.2,color:"#000090"},{val:0.4,color:"#000033"},{val:0.6,color:"#000040"},{val:0.8,color:"#0000ff"},{val:1,color:"#000000"}];$(".treemappanel",g).each(function(l,k){var m=ToolBox.stripSlash(window.location.pathname);var j=new Array();$(k).treemap({dimensions:$(".treemap.dimensions.active",g).data("dimensions"),nodeData:$(k).data("mapdata"),nodeBorderWidth:1,colorStops:f[$(".treemap.color.active",g).data("color")],leafNodeBodyGradient:function(o,r,q){var p=Math.min(r[2],r[3])*0.05;var n=Math.max(r[2],r[3]);var i=r[0]+r[2]*0.95;var t=r[1]+r[3]*Math.random();var s;if(isNaN(i)||isNaN(t)||isNaN(p)||isNaN(n)){s=o.createRadialGradient(0,0,0,0,0,0)}else{s=o.createRadialGradient(i,t,p,i,t,n)}s.addColorStop(0,TreemapUtils.lighterColor(TreemapUtils.rgb2hex(q),0.8));s.addColorStop(1,TreemapUtils.darkerColor(TreemapUtils.rgb2hex(q),0.1));return s}}).on("treemapclick",function(i,n){ToolBox.changeUri(m+"/"+n.nodes[0].uri)}).on("treemapmousemove",function(n,t){var o;if(j.el){o=j.el}else{o=$("<div/>").appendTo(g).addClass("diskusage treemap tooltip");j.el=o}if(t.nodes&&t.nodes[0].title){window.clearTimeout(j.timeout);var i=t.nodes[0].id;if(i.length>30){i=i.match(/.{30}/g).join("\\<br/>")}o.html(i+": "+t.nodes[0].val+"<br/>"+t.nodes[0].title.split(", ").join("<br/>"));var s=g.offset();var y=o.width();var u=o.height();var p=n.pageX-s.left+4;var w=n.pageY-s.top+4;var r=$(k).width();var x=$(k).height();var q=$(k).offset();if(n.pageX+y+4>q.left+r){p-=y+8}if(n.pageY+u+4>q.top+x){w-=u+8}var v=t.nodes[0].computedColor;o.css({position:"absolute",top:w+"px",left:p+"px","border-radius":"1px","box-shadow":"0px 0px 0px 4px rgba("+v[0]+","+v[1]+","+v[2]+",0.3)"}).show()}}).on("mouseout",function(){window.clearTimeout(j.timeout);j.timeout=window.setTimeout(function(){j.el.hide(200)},1000)});function h(i,n){$("."+n+".active",g).removeClass("active");i.addClass("active")}$(".treemap.byfoldersize",$(k).parent()).button().on("click",function(){h($(this),"sort");$(k).treemap("option","sizeOption",0);$(k).treemap("option","colorOption",0)});$(".treemap.byfilecount",$(k).parent()).button().on("click",function(){h($(this),"sort");$(k).treemap("option","sizeOption",1);$(k).treemap("option","colorOption",1)});$(".treemap.byfilesize",$(k).parent()).button().on("click",function(){h($(this),"sort");$(k).treemap("option","sizeOption",2);$(k).treemap("option","colorOption",2)});$(".treemap.dimensions",$(k).parent()).button().on("click",function(){h($(this),"dimensions");$(this).addClass("active");$(k).treemap("option","dimensions",$(this).data("dimensions"))});$(".treemap.color",$(k).parent()).button().on("click",function(){h($(this),"color");$(k).treemap("option","colorStops",f[$(this).data("color")])})})}function d(f){$(".diskusage.filetype.accordion").on("MyActivate",function(){$(".diskusage.filetype.piechart",f).each(function(j,h){var g=$(h);var l=g.attr("id");var k=AmCharts.makeChart(l,{type:"pie",theme:"light",legend:{position:"right",maxColumns:6,markerSize:8,markerLabelGap:2,spacing:1,verticalGap:1,fontSize:9,marginRight:5,autoMargins:false,marginLeft:0,valueText:"",valueWidth:0},dataProvider:g.data("json").data,valueField:"y",titleField:"x",balloonText:"[[x]]:[[l]] ([[percents]]%)",balloon:{fillColor:"#ffffff",fillAlpha:1},hideLabelsPercent:5,depth3D:15,angel:30,outlineAlpha:0.4,creditsPosition:"bottom-right"});k.write(l)})})}});