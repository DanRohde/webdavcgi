<!DOCTYPE html>
<html>
<head>
  <meta name="keywords" content="WebDAV CGI wrapper UID" />
  <meta name="author" content="Daniel Rohde" />
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8" /> 
  <link rel="stylesheet" type="text/css" href="style.css"/>
  <title>WebDAV CGI - Documentation</title>
</head>

<body>
<div id="content">
<nav class="navigation doc">
		<div class="button"><a href="index.html">Home</a></div>
		<div class="button"><a href="https://github.com/DanRohde/webdavcgi">Download</a></div>
		<div class="button"><a href="doc.html">Documentation</a></div>
</nav>
<h1>WebDAV CGI - Documentation</h1>
<div id="toc">
List of contents:
<ul>
	<li><a href="#requirements">Requirements</a></li>
	<li><a href="#installation">Installation</a></li>
	<li><a href="#upgrade">Upgrade</a></li>
	<li><a href="#setup">WebDAV CGI Setup</a>
		<ul>
		<li><a href="session.html" class="extern">Session or form-based authentication</a></li></ul>
	</li>
	<li><a href="#hints">Hints</a></li>
	<li><a href="#database">Database Setup</a></li>
	<li><a href="#wrapper">UID/GID Wrapper</a></li>
	<li><a href="#foldersharing">Folder Sharing / Group Access</a></li>
	<li><a href="#webinterface">Web interface</a>
		<ul>
		<li><a href="doc-simple-view.html" class="extern">The Simple View Documentation</a></li>
		<li><a href="extensions.html" class="extern">Extensions</a></li>
		</ul>
	</li>
	
	<li><a href="backends.html" class="extern">Backends: AFS, GFS, SMB/CIFS, DBB, ...</a></li>
	<li><a href="#performance">Performance</a></li>
	<li><a href="mod_perl.html" class="extern">Mod_Perl Support</a>
	<li><a href="#security">Security</a></li>
    <li><a href="troubleshooting.html#setup" class="extern">Troubleshooting Guide</a></li>
</ul>
<a href="index.html"><br/>Back to the WebDAV CGI home</a>

</div>
<h2 id="requirements">Requirements</h2>

<ul>
<li> all required Perl modules: see <a href="#installation">Installation</a> </li>
<li> a <a href="#database">database</a> (SQLite3, PostgreSQL, MySQL, ... (all supported by a Perl DBI driver))</li>
<li> a Web server software (Apache recommended)</li>
<li> a little bit configuration: Apache setup (see <a href="#installation">Installation</a>) and a <a href="#setup">WebDAV CGI Setup</a></li>
<li> WebDAV CGI works only with a UNIX/Linux server (Ubuntu 14.04/16.04 recommended, Windows/MacOS-X not tested and not supported) </li>
</ul>
<p>
You do not need mod_dav for the Apache Web server. WebDAV CGI replaces mod_dav completely. 
</p>
WebDAV CGI supports two authentication schemes:
<ul>
<li> Basic authentication as described in the following instruction</li>
<li> <a href="session.html">Session or form-based authentication</a></li>
</ul>

<h2 id="installation">Installation</h2>
<p>Note: All steps are done with root rights.</p>
<p>Upgrade Note: Please take a look at the <a href="#upgrade">Upgrade</a> section for further information.</p>
<ol>
<li><a href="index.html#download">download WebDAV CGI</a> (note: not necessary for Gentoo)</li>
<li>install required CPAN modules (Debian/Ubuntu package name):
  <ul>
    <li>CGI (included in most Linux dists; older dists need that: libcgi-perl)</li>
    <li>DBI (libdbi-perl) and a database driver, e.g. DBD::SQLite (libdbd-sqlite3-perl) - (since v0.3.0)</li>
    <li>Date::Parse (libtimedate-perl) - (since v0.2.1)</li>
    <li><del>OSSP::uuid (libossp-uuid-perl or from <a href="http://www.ossp.org/pkg/lib/uuid/">http://www.ossp.org/pkg/lib/uuid/</a>) - (since v0.3.0)</del> (since v0.8.0 replaced by UUID::Tiny)</li>
    <li>UUID::Tiny (libuuid-tiny-perl) - (since 0.8.0)</li>
    <li>XML::Simple (libxml-simple-perl)</li>
    <li>Quota (libquota-perl) - (since v0.3.4)</li>
    <li>Archive::Zip (libarchive-zip-perl) - (since v0.5.0)</li>
    <li><del>Image::Magick (perlmagick) - (since v0.5.1)</del> (since v0.5.3 replaced by Graphics::Magick)</li>
    <li>Graphics::Magick (libgraphics-magick-perl or <a href="http://www.graphicsmagick.org/perl.html">http://www.graphicsmagick.org/perl.html</a>) - (since v0.5.3)</li>
    <li>File::Spec::Link (libfile-copy-link-perl) - (since v0.5.2)</li>
    <li>IO::Compress::Gzip (included in most Linux dists) - (since v0.7.0)</li>
    <li>IO::Compress::Deflate (included in most Linux dists) - (since v0.7.0)</li>
    <li>IO::Compress::Brotli - (since v1.1.2)</li>
    <li>Module::Load (included in most Linux dists, older need libmodule-load-perl) - (since v0.8.0)</li>
    <li><span style="optional">optional (for SMB backend):</span> Filesys::SmbClient (libfilesys-smbclient-perl) - (since v0.8.0)</li>
    <li><span style="optional">optional (for RCS backend):</span> Rcs (librcs-perl) - (since v0.8.0)</li>
    <li>JSON (libjson-perl) - (since v0.8.5)</li>
    <li>DateTime - (since v0.8.5)</li>
    <li>DateTime::Format::Human::Duration - (since v0.8.5)</li>
    <li>Image::ExifTool (libimage-exiftool-perl)- (since v1.0.1)</li>
    <li>List::MoreUtils (liblist-moreutils-perl)- (since v1.1.0)</li>
    <li><span style="optional">optional for SendByMail extension:</span>MIME::Entity (libmime-tools-perl) - (since v0.9.1)</li>
    <li><span style="optional">optional for LDAP address book of SendByMail extension:</span>Net::LDAP (libnet-ldap-perl) - (since v0.9.1)</li>
    <li><span style="optional">optional for Kerberos helpers in conjunction with mod_perl (AFS, SMB):</span>Env::C - (since v1.0.0)</li>
    <li><span style="optional">optional for AFS Kerberos helpers in conjunction with mod_perl:</span>AFS::PAG - (since v1.0.1)</li>
  </ul>
   You can do that with '<code>perl -MCPAN -e "install &lt;ModuleName&gt;"</code>' or with '<code>apt-get install &lt;PackageName&gt;</code>'.
   <pre>
## Debian/Ubuntu quick install: 
apt install libdbi-perl libdbd-sqlite3-perl sqlite3 libtimedate-perl \
            libuuid-tiny-perl libxml-simple-perl libquota-perl \
            libarchive-zip-perl libgraphics-magick-perl libmodule-load-perl \
            libfile-copy-link-perl libjson-perl libdatetime-perl \
            libmime-tools-perl libnet-ldap-perl libimage-exiftool-perl \
            liblist-moreutils-perl libcgi-session-perl libwww-csrf-perl
            
cpan install DateTime::Format::Human::Duration

cpan install IO::Compress::Brotli

## only for PostgreSQL users:
apt install libdbd-pg-perl

## only for MySQL users:
apt install libdbd-mysql-perl

## only for SMB backend users:
apt install libfilesys-smbclient-perl smbclient krb5-user

## only for RCS backend users:
apt install librcs-perl

## only for AFS users:
apt install openafs-client krb5-user openafs-krb5 libafs-pag-perl

## for mod_perl users with Kerberos (SMB, AFS) authentication:
cpan install Env::C

</pre>   
</li>
<li>install additional binaries/packages for a better WebDAV CGI experience:
<ul>
<li> Ghostscript - allows the web interface of WebDAV CGI to generate thumbnails for PDF/PS files (Debian/Ubuntu package: ghostscript) </li>
<li> smbclient (only for SMB backend users) - allows the web interface to show quota information (Debian/Ubuntu package: smbclient) </li>
<li> kinit (only for SMB and AFS backend users) - allowed you to omit mod_auth_kerberos (Debian/Ubuntu package: krb5-user) </li>
<li> libreoffice - allows file conversions</li>

</ul>
<pre>
## Debian/Ubuntu quick install:
apt install  ghostscript

## only for SMB backend users:
apt install smbclient

## only for SMB and AFS backend users:
apt install krb5-user

## for ODFConverter extension:
apt install libreoffice

</pre>
<pre>
## Gentoo quick install:
emerge -va app-text/ghostscript-gpl

## only for SMB backend users:
emerge -va net-fs/cifs-utils

## only for SMB and AFS backend users:
emerge -va app-crypt/heimdal
</pre>
</li>
<li>install locales
<pre>
## Debian/Ubuntu quick install:
rm -f /var/lib/locales/supported.d/webdavcgi
for l in de_DE en_US fr_FR it_IT hu_HU ; do
        fgrep $l /usr/share/i18n/SUPPORTED >> /etc/locale.gen
done
locale-gen
</pre></li>
<li>change directory to your preferred installation path, e.g. <code>cd /etc</code></li>
<li>install WebDAV CGI:
<ul><li><code>unzip webdavcgi-latest.zip</code> or <code>tar jxf webdavcgi-latest.tar.gz2</code> (Gentoo: <code>emerge -va www-apps/webdavcgi</code>)</li>
<li>OR  clone the Git repo (preferred): <code>git clone https://github.com/DanRohde/webdavcgi.git</code></li>
</ul>
</li>
<li>change directory to the source base (e.g: <code>cd webdavcgi*</code>) and call <code>bash install.sh</code> to compile all wrappers and to fix file permissions </li>
<li> <a href="#setup">configure webdav.pl</a></li>
<li> <a id="apache"></a>configure your web server:
    <ul>
    <li>you can do that with rewrite rules (recommended)</li>
    <li> or with a handler action (unsupported)</li>
    </ul>
    Examples for Apache 2.x: (you need the Apache rewrite module: <code>a2enmod rewrite</code>) 
    - and don't forget to take a look at the backend specific configuration: <a href="backends.html#afs">AFS</a>, <a href="backends.html#gfs">GFS</a>, <a href="backends.html#smb">SMB/CIFS</a>, <a href="backends.html#dbb">DBB</a>, or <a href="backends.html#rcs">RCS</a>
    <pre>
### EXAMPLE 1: a complete (virtual) server root handled by WebDAV CGI:
ScriptAlias /webdavcgi /etc/webdavcgi/cgi-bin/webdavwrapper
# ScriptAlias /logout /etc/webdavcgi/cgi-bin/logout
&lt;Location /webdavcgi&gt;
        AuthType Basic
        AuthName "WebDAV space"
        AuthUserFile /path-to-my-auth-file
        Require valid-user
&lt;/Location&gt;
RewriteEngine On
# RewriteRule /logout - [L]
RewriteRule ^/ /webdavcgi [PT,E=WEBDAVCONF:/etc/webdav.conf,E=PERLLIB:/etc/webdavcgi/lib/perl,L]
    </pre>
<br/>
    <pre>
### EXAMPLE 2: a virtual path /webdav
ScriptAlias /webdavcgi /etc/webdavcgi/cgi-bin/webdavwrapper
# ScriptAlias /webdav/logout /etc/webdavcgi/cgi-bin/logout
&lt;Location /webdavcgi&gt;
        AuthType Basic
        AuthName "WebDAV space"
        AuthUserFile /path-to-my-auth-file
        Require valid-user
&lt;/Location&gt;
# if you want to map this to a real path, do that:
# (and setup $VIRTUAL_BASE='/webdav/?' and $DOCUMENT_ROOT in your WebDAV CGI config)
RewriteEngine On
# RewriteRule ^/webdav/logout - [L]
RewriteRule ^/webdav /webdavcgi  [PT,E=WEBDAVCONF:/etc/webdav.conf,E=PERLLIB:/etc/webdavcgi/lib/perl,L]
    </pre>
<br/>
    <pre>
### EXAMPLE 3: a .htaccess file to handle a complete folder with WebDAV CGI:
### Prerequisites: /webdavcgi is a script alias 
##       (ScriptAlias /webdavcgi /etc/webdavcgi/cgi-bin/webdavwrapper) and
###      'AllowOverride AuthConfig FileInfo' is set for the current folder
RewriteEngine On
RewriteRule .* /webdavcgi [E=WEBDAVCONF:/etc/webdav.conf,E=PERLLIB:/etc/webdavcgi/lib/perl]

AuthType Basic
AuthName "A protected WebDAV folder"
AuthUserFile /path-to-my-auth-file
Require valid-user
    </pre>
</li>

</ol>
<h2 id="upgrade">Upgrade</h2>
<h3>Upgrading from 1.1.2 to 1.1.3</h3>
<ul>
<li> $MIMEFILE default changed to <code>/etc/mime.types</code></li>
</ul>
<h3>Upgrading from 1.1.1 to 1.1.2</h3>
<ul>
<li> Brotli compression was added: Perl module IO::Compress::Broli required (<code>cpan install IO::Compress::Brotli</code>)
<li> The web interface was refactored:
	<ul>
	<li> folder upload was implemented (by form and D&D) and can be disabled with <code>$ALLOW_FOLDERUPLOAD=0;</code> in webdav.conf</li>
	<li> $HEADER and $LANGSWITCH defaults were changed</li>
	<li> menus in toolbar and navigation bar are allowed now</li>
	<li> the new $ALLOW_PATHINFO (default: 0) enables former enabled path input in toolbar (quick navigation) again</li>
	</ul>
</li>
<li> The new <a href="extensions.html#Localizer">Localizer extension</a> allows an easy translation of the Web interface (locales and help files).</li>
<li>  The new extension <a href="extensions.html#MotD">MotD</a> is activated by default now and shows /etc/motd as a dialog to the web users of WebDAV CGI.</li>
</ul>
<h3>Upgrading from 1.1.0 to 1.1.1</h3>
<ul>
<li> Feedback extension was added.</li>
<li> SaveSettings extension was added.</li>
<li> Some config variables were added:
	<ul>
	<li><code>$OPTIMIZERTMP</code> - contains absolute path for caches: message, CSS, JS (default: /tmp)</li>
	<li><code>$READBUFSIZE</code> - contains buffer size for local file reads (default: 65536)</li>
	</ul>
</li>
</ul>
<h3>Upgrading from 1.0.0 to 1.1.0</h3>
<ul>
<li> A new Perl module is required: List::MoreUtils (Debian/Ubuntu: <code>apt-get install liblist-moreutils-perl</code>)</li>
<li> The new ImageInfo extensions needs the additional Perl module Image::ExifTool<br> (Debian/Ubuntu: <code>apt-get install libimage-exiftool-perl</code>, CPAN: <code>perl -MCPAN -e "install Image::ExifTool"</code>)</li>
<li> It's now possible to use AFS in conjunction with mod_perl and without mod_waklog, but it makes it necessary to install a new Perl module: AFS::PAG (Debian: <code>apt-get install libafs-pag-perl</code> or <code>perl -MCPAN -e "install AFS::APG"</code>).</li>
<li> GPXViewer extension was added.</li>
<li> QuickToggle extension was added.</li>
<li> VideoJS extension was added.</li>
<li> A statusbar was added (see settings dialog).</li>
<li> Hungarian language was added. Don't forget to add the necessary locale <code>hu_HU.UTF-8 UTF-8</code></li>
<li> New config variables were added and can be used for an easier upgrade (don't change this variables) if you use it for your <code>@EXTENSIONS</code> list in your <code>webdav.conf</code>, e.g. <code>@EXTENSIONS = (@DEFAULT_EXTENSIONS, @EXTRA_EXTENSIONS);</code>:
	<ul>
	<li><code>@DEFAULT_EXTENSIONS</code> - contains a list of useful extensions</li>
	<li><code>@AFS_EXTENSIONS</code> - contains a list of AFS backend related extensions</li>
	<li><code>@EXTRA_EXTENSIONS</code> - contains a list of special extensions (e.g. GPXViewer, SourceCodeViewer, HexDump, SendByMail)</li>
	<li><code>@PUB_EXTENSIONS</code> - contains a list of public URI extensions</li>
	<li><code>@DEV_EXTENSIONS</code> - contains a list for WebDAV CGI developers (e.g. PropertiesViewer, SysInfo)</li>
	</ul>
</li> 
</ul>
<h3>Upgrading from 0.9.0 to 1.0.0</h3>
<ul>
<li> The database schema has some bugs so it needs a update (please kill all speedy processes before you start with the database schema changes):
<pre>
# PostgreSQL:
ALTER TABLE webdav_locks ALTER COLUMN basefn TYPE varchar(5000);
ALTER TABLE webdav_locks ALTER COLUMN fn TYPE varchar(5000);
ALTER TABLE webdav_locks ALTER COLUMN type DROP not null;
ALTER TABLE webdav_props ALTER COLUMN fn TYPE varchar(5000);


# MySQL:
ALTER TABLE webdav_locks MODIFY basefn varchar(5000) not null;
ALTER TABLE webdav_locks MODIFY fn varchar(5000) not null;
ALTER TABLE webdav_locks MODIFY type varchar(255);
ALTER TABLE webdav_props MODIFY fn varchar(5000) not null;


# SQLite:
DROP INDEX webdav_locks_idx1;
DROP INDEX webdav_locks_idx2;
DROP INDEX webdav_locks_idx3;
DROP INDEX webdav_locks_idx4;
ALTER TABLE webdav_locks RENAME TO webdav_locks_old;
DROP INDEX webdav_props_idx1;
DROP INDEX webdav_props_idx2;
ALTER TABLE webdav_props RENAME TO webdav_props_old;
CREATE TABLE webdav_locks (basefn VARCHAR(5000) NOT NULL, fn VARCHAR(5000) NOT NULL, type VARCHAR(255), scope VARCHAR(255), token VARCHAR(255) NOT NULL, depth VARCHAR(255) NOT NULL, timeout VARCHAR(255) NULL, owner TEXT NULL, timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE webdav_props (fn VARCHAR(5000) NOT NULL, propname VARCHAR(255) NOT NULL, value TEXT);
CREATE INDEX webdav_locks_idx1 ON webdav_locks (fn);
CREATE INDEX webdav_locks_idx2 ON webdav_locks (basefn);
CREATE INDEX webdav_locks_idx3 ON webdav_locks (fn,basefn);
CREATE INDEX webdav_locks_idx4 ON webdav_locks (fn,basefn,token);
CREATE INDEX webdav_props_idx1 ON webdav_props (fn);
CREATE INDEX webdav_props_idx2 ON webdav_props (fn,propname);
INSERT INTO webdav_locks SELECT * FROM webdav_locks_old;
INSERT INTO webdav_props SELECT * FROM webdav_props_old;
DROP TABLE webdav_locks_old;
DROP TABLE webdav_props_old;

</pre>
</li>
<li> mod_perl is now supported for AFS and SMB backends</li>
<li> ZIP download and upload moved to new extension Zip. Expand your extension list to activate it <code>@EXTENSIONS = ( 'Zip', ...);</code></li>
<li> The AFS Group Manager is an extension now. Add 'AFSGroupManger' to your extensions list to activate it. </li>
<li> The AFS ACL Manager is an extension now. Add 'AFSACLManager' to your extensions list to use it.</li>
<li> Search support was moved to a new extension (Search). Expand your extension list to enable search <code>@EXTENSIONS=('Search',...);</code></li>
<li> The option '$ALLOW_EDIT' was removed, instead use or not use 'TextEditor' extension: <code>@EXTENSION=('TextEditor',....);</code>
<li> The option '@EDITABLEFILES' was removed, instead configure 'TextEditor' extension: <code>$EXTENSION_CONFIG{TextEditor}{editablefiles}=\@EDITABLEFILES;</code>  
<li> A lot of new <a href="extensions.html">extensions</a> were added (activation: <code>@EXTENSIONS= ('ExtensionName1', 'ExtensionName2', ...  );</code>):
	<ul>
	<li> AFSACLManager - enables AFS ACL management</li>
	<li> AFSGroupManager - enables AFS Group management</li>
	<li> Diff - compares two files/folders</li>
	<li> DiskUsage - shows disk usage for folders</li>
	<li> Download - adds a download button</li>
	<li> HexDump - shows a hexdump</li>
	<li> Highlighter - colorize text and backgrounds of files and folders</li>
	<li> History - shows a folder history</li>
	<li> ODFConverter - converts between Open Document file formats and other Office file formats</li>
	<li> Permissions - manage POSIX file permissions (user,group,others:rwxst)</li>
	<li> PosixAclManager - allows POSIX ACL changes</li>
	<li> Redirect - redirects folders to any web page</li>
	<li> Search - enables file/content search support</li>
	<li> SendByMail - sends files/folders by e-mail ( Perl module MIME::Entity from MIME tools required; Debian/Ubuntu: <code>apt-get install libmime-tools-perl</code>)</li>
	<li> SourceCodeViewer - shows syntax highlighted source code</li>
	<li> TextEditor - allows text file modifications</li>
	<li> ViewerJS - shows OpenDocument and PDF files</li>
	<li> Zip - allows ZIP download for files/folders and ZIP upload with decompression</li>
	</ul>
</li>
</ul>
<h3>Upgrading from 0.8.6 to 0.9.0</h3>
<ul>
<li> The classic view and the sidebar view are removed from code base.
	<ul><li> %UI_ICONS configuration variable is obsolete and was removed</li></ul></li>
<li> The complete backend configuration was changed:
<ul>
<li><code>%FSVLINK=(...);</code> was replaced by <code>$BACKEND_CONFIG{FS}{fsvlink}={...};</code></li>
<li><code>%SMB=(...);</code> was replaced by <code>$BACKEND_CONFIG{SMB}={...};</code></li>
<li><code>%RCS=(...);</code> was replaced by <code>$BACKEND_CONFIG{RCS}={...};</code></li>
<li><code>$GFSQUOTA='...';</code> was replaced by <code>$BACKEND_CONFIG{GFS}{quota}='...';</code></li>
<li><code>$AFS_FSCMD='...';</code> was replaced by <code>$BACKEND_CONFIG{AFS}{fscmd}='...';</code></li>
<li><code>$AFSQUOTA='...';</code> was replaced by <code>$BACKEND_CONFIG{AFS}{quota}='...';</code></li>
<li><code>%DBB=(...);</code> was replaced by <code>$BACKEND_CONFIG{DBB}={...};</code></li>
</ul></li>
<li> A extension configuration variable was added: <code>%EXTENSION_CONFIG</code></li>
</ul>
<h3>Upgrading from 0.8.5 to 0.8.6</h3>
<ol>
<li>The Simple View:
<ul>
<li>Home button template was changed: <code>data-action="changeuri"</code> was replaced by <code>class="action changeuri"</code> (see <a href="doc-simple-view.html#hooks">The Simple View Documentation</a>)</li></ul></li>
</ol>
<h3>Upgrading from 0.8.4 to 0.8.5</h3>
<ol>
<li> the SVN repository URL has changed: <code> svn switch --relocate https://webdavcgi.svn.sourceforge.net/svnroot/webdavcgi/trunk http://svn.code.sf.net/p/webdavcgi/code/trunk</code></li>
<li> the default view was changed from 'sidebar' to 'simple' </li>
<li> new Perl modules are needed:
  <ul>
  	<li><code>JSON</code> (Ubuntu/Debian package: libjson-perl)</li>
	<li><code>DateTime</code> (Ubuntu/Debian package: libdatetime-perl</li>
	<li><code>DateTime::Format::Human::Duration</code> (CPAN) </li>
  </ul>
 </li>
<li> SMB backend: the new optional flag 'secure' was added to enable a URL check for allowed servers and shares</li>
</ol>
<h3>Upgrading from 0.8.3 to 0.8.4</h3>
<ol>
<li> The new install.sh script does not copy or link webdav.pl and webdavwrapper to your cgi-bin directory. You can add/change ScriptAliases to use webdav.pl
or a webdavwrapper from your installation src, e.g. 
<pre>ScriptAlias /webdavcgi /etc/webdavcgi/cgi-bin/webdavwrapper
RewriteRule ^/ /webdavcgi [PT,L,E=WEBDAVCONF:/etc/webdav.conf,E=PERLLIB:/etc/webdavcgi/lib/perl]
&lt;Location /webdavcgi&gt;
	AuthType Basic
	AuthUserFile /etc/apache2/webabusers
	AuthName "WebDAV space"
	Require valid-user
&lt;/Location&gt;	
</pre>
</li>
<li>AFS backend:
	<ul>
		<li> Speedy support for AFS was added and a mod_auth_kerberos free installation is now possible:
			<ul><li>a new setuid/setgid wrapper was added: helper/webdavwrapper-afs.c (mod_waklog isn't required if you use webdavwrapper-afs.c)</li>
			<li>a PAG script was added: cgi-bin/afswrapper</li> 
			<li>visit <a href="backends.html#afs">AFS</a> section for details</li>
		   </ul>
		</li>
	<li>mod_waklog is no longer required for AFS</li>
	</ul>
</li>
<li>SMB backend:
	<ul><li> a wrapper for mod_auth_kerberos free installation was added</li>
	<li>username/password/workgroup authentication support was added</li>
	</ul></li>
</ol>
<h3>Upgrading from 0.8.2 to 0.8.3</h3>
<ol>
<li>changed <code>@UNSELECTABLE_FOLDERS</code> default to <code>()</code> (relevant for AFS backend users)</li>
<li>changed <code>helper/webdavwrapper-smb.c</code> to fix a Kerberos ticket bug (relevant for SMB backend users)</li>
</ol>

<h3>Upgrading from 0.8.1 to 0.8.2</h3>
<ol>
<li> see <a href="#speedy">Speedy support</a> section to improve the WebDAV CGI performance</li>
</ol>
<h3>Upgrading from 0.8.0 to 0.8.1</h3>
<ol>
<li> <code>%AUTOREFRESH</code> was added for the new auto-refresh feature</li>
</ol>
<h3>Upgrading from 0.7.x to &ge;0.8.0</h3>
<ol>
<li> a new Perl module is needed: <code>Module::Load</code> (Ubuntu/Debian package: libmodule-load-perl)</li>
<li> <code>OSSP::uuid</code> Perl module was replaced by <code>UUID::Tiny</code> (Ubuntu/Debian package: libuuid-tiny-perl)</li>
<li> WebDAV CGI comes with some own modules so you need to set a additional Perl library path:
     <ul>
	     <li>add <code>E=PERLLIB:/etc/webdavcgi/lib/perl</code> to your rewrite rule options in the Apache configuration</li>
	     <li>OR add <code>SetEnv PERLLIB /etc/webdavcgi/lib/perl</code> to your Apache configuration (don't forget to activate/install env module, e.g. <code>a2enmod env; /etc/init.d/apache restart</code>) </li>
	     <li>OR change shebang of webdav.pl to <code>#!/usr/bin/perl -I/etc/webdavcgi/lib/perl</code></li>
     </ul>
</li>
<li> <code>$IGNOREFILEPERMISSIONS</code> config variable was removed</li>
<li> <code>$BACKEND</code> variable was added and is required (allowed values: 'FS', 'AFS', 'GFS', 'SMB', 'DBB') </li>
<li> <code>$SHOW_MIME</code> and <code>$SHOW_PERM</code> were removed: use the new options <code>@ALLOWED_TABLE_COLUMNS</code> and <code>@VISIBLE_TABLE_COLUMNS</code> instead</li>
<li> <code>%MIMETYPES</code> format was changed: only a single filename suffix is allowed as a key (instead of a space separated list of suffixes); please use <code>$MIMEFILE</code> instead</li>
<li> <code>@EXTENSIONS</code> parameter was added: contains a list of extensions </li>
<li> <code>$ENABLE_SYSINFO</code> was removed: add <code>'SysInfo'</code> to the <code>@EXTENSIONS</code> list</li>
<li> <code>$ENABLE_PROPERTIES_VIEWER</code> was removed: add <code>'PropertiesViewer'</code> to the <code>@EXTENSIONS</code> list</li>
<li> <code>$ENABLE_SIDEBAR</code> was removed: use <code>@SUPPORTED_VIEWS</code> instead</li>
<li> <code>$MAXLASTMODIFIEDSIZE</code> was removed</li>
<li> <code>$MAXNAVPATHSIZE</code> was added</li>
</ol>
<h3>Upgrading from &le;0.6.x to &ge;0.7.x</h3>
<ol>
<li>two new Perl modules are used by WebDAV CGI: <code>IO::Compress::Gzip</code> and <code>IO::Compress::Deflate</code> (both are integrated in most Linux dists)</li>
<li>WebDAV CGI is no longer a single file distribution therefore:
	<ol>
	<li>unpack the new <a href="index.html#download">installation package</a> in your preferred installation path, e.g. <code>cd /etc; unzip webdavcgi-0.7.?.zip</code></li>
	<li>link the path for easier upgrades, e.g. <code>ln -s /etc/webdavcgi-0.7.? /etc/webdavcgi</code></li>
	<li>copy the webdav.pl script to your CGI directory and allow execution, e.g. 
<pre>cp /etc/webdavcgi/cgi-bin/webdav.pl /usr/lib/cgi-bin 
chmod a+x /usr/lib/cgi-bin/webdav.pl </pre></li>
	<li>add the <code>$INSTALL_BASE</code> variable to your existing <code>/etc/webdav.conf</code>, e.g. 
		<pre>echo "\$INSTALL_BASE='/etc/webdavcgi/';" &gt;&gt; /etc/webdav.conf</pre></li>
	<li>check your config file and modules, e.g.
<pre>#&gt; perl -c /etc/webdav.conf
webdav.conf syntax OK

#&gt; perl -I/etc/webdavcgi/lib/perl -c /usr/lib/cgi-bin/webdav.pl
webdav.pl syntax OK

#&gt; bash /etc/webdavcgi/checkenv
+++ Checking perl:
  perl /usr/bin/perl
++++ Checking required modules:
  CGI installed
  DBI installed
  POSIX installed
  File::Temp installed
  Date::Parse installed
  UUID::Tiny installed
  XML::Simple installed
  Quota installed
  Archive::Zip installed
  IO::Compress::Gzip installed
  IO::Compress::Deflate installed
  Digest::MD5 installed
  Module::Load installed
++++ Checking optional modules:
  DBD::SQLite installed
  DBD::mysql installed
  DBD::Pg installed
++++ Checking required modules for FS backend:
  File::Spec::Link installed
++++ Checking required modules for AFS backend:
  File::Spec::Link already checked
++++ Checking required modules for GFS backend:
  File::Spec::Link already checked
++++ Checking required modules for SMB backend:
  Filesys::SmbClient installed
++++ Checking required modules for RCS backend:
  Rcs installed
++++ Checking optional binaries:
  smbclient /usr/bin/smbclient
#### Summary:
All modules found.
All binaries found. </pre></li>
	</ol>
</li>
<li>WebDAV CGI has a new Web interface and some configuration defaults were changed and new options were added. See CHANGELOG in your installation path and take a look into webdav.pl for further information.</li>
</ol>



<h2 id="setup">WebDAV CGI Setup</h2>
The WebDAV CGI can be easier upgraded if you use a configuration file instead of changing the setup section of <code>webdav.pl</code>.
<ol>
<li> Create a <code>/etc/webdav.conf</code> with a minimal setup and don't forget to fix file permissions: <br/><code>chmod a+r /etc/webdav.conf</code>:
<pre>
## the install base is needed to find webdav-ui.* and locale files 
## (don't forget the trailing slash):
$INSTALL_BASE = '/etc/webdavcgi/';

## the backend module (supported: FS, AFS, GFS, SMB, DBB, RCS, GIT):
$BACKEND = 'FS';

## this is an example if a user starts with home dir (http://mywebdavserver/ -&gt; user home):
$VIRTUAL_BASE = '/';
$DOCUMENT_ROOT = '/home/'.$ENV{REMOTE_USER}.'/';
## if you use a complex home folder structure, try this:
# $DOCUMENT_ROOT=(getpwnam($ENV{REMOTE_USER}))[7].'/';


$DBI_SRC='dbi:SQLite:dbname=/tmp/webdav.'.$ENV{REMOTE_USER}.'.db';
$DBI_USER='';
$DBI_PASS=''; 
$CREATE_DB = !-e '/tmp/webdav.'.$ENV{REMOTE_USER}.'.db';

</pre>
</li>
<li> Please take a look at backend specific configuration sections <a href="backends.html#afs">AFS</a>, <a href="backends.html#gfs">GFS</a>, <a href="backends.html#smb">SMB/CIFS</a>, <a href="backends.html#dbb">DBB</a>, <a href="backends.html#rcs">RCS</a>, <a href="backends.html#git">GIT</a></li>
<li> <a href="#database">Set up your database</a> </li>
<li> If you need to change other options, take a look at <code>etc/webdav.conf.complete</code></li>
<li> Enable <a href="session.html" class="extern">session or form-based authentication</a> if needed.</li> 
<li> There are a lot of <a href="extensions.html">extensions</a> to activate. </li> 
<li> Don't forget to check the config file syntax: <code>perl -c /etc/webdav.conf</code></li>
<li> <a href="#apache">configure your Apache web server</a></li>
</ol>
<h2 id="hints">Hints</h2>
Apache and webdav.pl setup:
   <ul>
   <li> You can use Apache's <code>'SetEnv VAR VAL'</code> or <code>'RewriteRule ... [E=VAR:VAL]'</code> in conjunction with <code>'$ENV{VAR}'</code> in your config to setup WebDAV CGI. This allows you a path based, virtual host based or user based configuration.</li>
   <li>see <a href="#performance">Performance</a> section for more.</li>
   </ul>

Graphics::Magick does not compile:
<ul>
<li>RedHat/Fedora/CentOS: see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=527143#c2">https://bugzilla.redhat.com/show_bug.cgi?id=527143#c2</a></li>
<li> You can use Image::Magick instead but it makes trouble in conjunction with <a href="#speedy">Speedy</a>: 
<pre>sed -i -e 's@Graphics::Magick@Image::Magick@g' \
                checkenv \
		lib/perl/WebInterface/Renderer.pm</pre>
</li>
</ul>

<h2 id="database">Database Setup</h2>
<h3>Common Instructions</h3>
<ol>
<li> Install the necessary Perl DBI driver (Debian/Ubuntu package: libdbd-...-perl) </li>
<li> Create the database and the schema </li>
<li> Configure WebDAV CGI (<code>$DBI_SRC, $DBI_USER, $DBI_PASS</code>)</li>
</ol>

<h3>SQLite 3</h3>
<ul>
<li> DBI driver for SQLite3: Debian/Ubuntu package: <code>libdbd-sqlite3-perl</code></li>
<li> You can use the auto create feature (<code>$CREATE_DB=1;</code>) </li>
<li> Example config:
<pre>
$DBI_SRC='dbi:SQLite:dbname=/tmp/webdav.'.$ENV{REMOTE_USER}.'.db';
$DBI_USER="";
$DBI_PASS="";
$CREATE_DB = !-e '/tmp/webdav.'.$ENV{REMOTE_USER}.'.db';
</pre>
</li>
</ul>
<h3>PostgreSQL</h3>
<ul>
<li>DBI driver for PostgreSQL: Debian/Ubuntu package: <code>libdbd-pg-perl</code></li>
<li> Disable the auto create feature (<code>$CREATE_DB = 0;</code>) and create the database schema with following statements (the database 'webdavcgi' must exists), e.g:
<pre>
## Ubuntu/Debian:
apt-get install postgresql postgresql-client

su - postgres 

createuser webdavcgi -P

createdb -O webdavcgi webdavcgi 

psql webdavcgi &lt;&lt;EOF

CREATE TABLE webdav_locks (basefn VARCHAR(5000) NOT NULL, fn VARCHAR(5000) NOT NULL, 
			   type VARCHAR(255), scope VARCHAR(255), 
			   token VARCHAR(255) NOT NULL, depth VARCHAR(255) NOT NULL, 
			   timeout VARCHAR(255) NULL, owner TEXT NULL, 
			   timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE webdav_props (fn VARCHAR(5000) NOT NULL, propname VARCHAR(255) NOT NULL, value TEXT);
CREATE INDEX webdav_locks_idx1 ON webdav_locks (fn);
CREATE INDEX webdav_locks_idx2 ON webdav_locks (basefn);
CREATE INDEX webdav_locks_idx3 ON webdav_locks (fn,basefn);
CREATE INDEX webdav_locks_idx4 ON webdav_locks (fn,basefn,token);
CREATE INDEX webdav_props_idx1 ON webdav_props (fn);
CREATE INDEX webdav_props_idx2 ON webdav_props (fn,propname);


GRANT ALL ON ALL TABLES IN SCHEMA public TO webdavcgi;

EOF

</pre>
</li>
<li> Example config:
<pre>
$DBI_SRC='dbi:Pg:dbname=webdavcgi;host=localhost;port=5432';
$DBI_USER='webdavcgi';
$DBI_PASS='changeme';
$CREATE_DB = 0;
</pre>
</li>
</ul>
<h3>MySQL</h3>
<ul>
<li> DBI driver for MySQL: Debian/Ubuntu-Package: <code>libdbd-mysql-perl</code></li>
<li> Disable the auto create feature (<code>$CREATE_DB = 0;</code>) and create the database schema with following statements (the database 'webdavcgi' must exists), e.g.:
<pre>
mysql -p webdavcgi &lt;&lt;EOF

CREATE TABLE webdav_locks (basefn VARCHAR(5000) NOT NULL, fn VARCHAR(5000) NOT NULL, 
                           type VARCHAR(255), scope VARCHAR(255), 
                           token VARCHAR(255) NOT NULL, depth VARCHAR(255) NOT NULL, 
                           timeout VARCHAR(255) NULL, owner TEXT NULL, 
                           timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE webdav_props (fn VARCHAR(255) NOT NULL, propname VARCHAR(255) NOT NULL, value TEXT);
CREATE INDEX webdav_locks_idx1 ON webdav_locks (fn);
CREATE INDEX webdav_locks_idx2 ON webdav_locks (basefn);
CREATE INDEX webdav_locks_idx3 ON webdav_locks (fn,basefn);
CREATE INDEX webdav_locks_idx4 ON webdav_locks (fn,basefn,token);
CREATE INDEX webdav_props_idx1 ON webdav_props (fn);
CREATE INDEX webdav_props_idx2 ON webdav_props (fn,propname);

EOF

</pre>
</li>
<li> Example config:
<pre>
$DBI_SRC='DBI:mysql:database=webdavcgi;host=localhost;port=3306';
$DBI_USER='mysqluser';
$DBI_PASS='changeme';
$CREATE_DB=0;
</pre>
</li>
</ul>

<h2 id="wrapper">UID/GID Wrapper</h2>
If you use the example wrapper (<code>webdavwrapper.c</code>, <code>webdavwrapper-krb.c</code>, <code>webdavwrapper-afs.c</code>) you should consider this:
<ul>
<li> Your operating system have to know all your WebDAV users. The following command should display a complete passwd entry (replace UID with a account name):
<pre>
getent passwd UID

# OR

getent passwd 
# should display all users
</pre>
Configure NSSWITCH (/etc/nsswitch.conf) to make your user accounts usable.
</li>
<li> The owner and group must be root: <code>chown root:root cgi-bin/webdavwrapper*</code></li>
<li> The <code>webdavwrapper</code> binary needs set-user-ID and the set-group-ID bit to change the user ID and the group ID at runtime. Of course it needs also execute flags.
<pre>
chmod ug+s,a+x cgi-bin/webdavwrapper*
</pre>
</li>
</ul>
Attention: for AFS and/or Kerberos support you need <code>webdavwrapper-afs.c</code> or <code>webdavwrapper-krb.c</code> instead of <code>webdavwrapper.c</code> (see <a href="backends.html#afs">AFS Support</a> section)

<h2 id="foldersharing">Folder Sharing / Group Access</h2>
There are two ways to share a folder between users of a group (not for AFS users - see AFS note below):
<ol>
<li> Add all users to UNIX/Posix group (/etc/groups, a LDAP group, ...) - recommended:
	<ul>
		<li> create a group, e.g: <code>groupadd GROUP</code></li>
		<li> create a folder to share: <code> mkdir SHAREDFOLDER</code> </li>
		<li> change the group: <code>chgrp GROUP SHAREDFOLDER</code></li>
		<li> set set-GID-flag to the folder and make it readable/executable/writeable for the group: <code>chmod g+srwx SHAREDFOLDER</code></li>
		<li> set the <code>$UMASK</code> parameter in your WebDAV CGI config file: <code>$UMASK = 0002;</code></li>
	</ul>
Attention: You need a single database for all users to share WebDAV locks and properties. If you use a file based database like SQLite you have to use a singe file writable for all users.

</li>
<li> Use the UID/GID Wrapper to map all users to a common user:
	<ul>
		<li> create a common user, e.g.:<code>adduser USER</code></li>
		<li> create a folder to share: <code> mkdir SHAREDFOLDER</code></li>
		<li> change the owner: <code>chown USER SHAREDFOLDER</code></li>
		<li> set the WEBDAV_USER environment variable: add <code>E=WEBDAV_USER:USER</code> to your Apache rewrite rule option</li>
	</ul>
</li>
</ol>

AFS note: If you use AFS you have to use AFS groups and AFS ACLs to share folders instead of folder permissions because AFS ignores all Linux/UNIX permissions:
<ol>
<li> Create a AFS group and add AFS users to the group. </li>
<li> Set lookup, read, write, delete, insert, and lock rights for that group to the shared folder.</li>
<li> Don't forget to set lookup rights for the AFS group to all upper folders.</li>
</ol>

<h2 id="webinterface">Web interface</h2>
<h3>How to add a new translation</h3>
<div>
<p>
Since WebDAV CGI v1.1.2 there is a Localizer extension that helps you to translate all locale and online help files. Activate it by putting @DEV_EXTENSIONS or 'Localize' to
your @EXTENSIONS setup (see <a href="extensions.html">extensions doc</a>) in your webdav.conf. And you need write permissions for all locale and online help files, e.g.
<pre>
find /etc/webdavcgi/ -name locale -type d -exec chmod -R a+w {} \;
find /etc/webdavcgi/ -name help -type d -exec chmod -R a+w {} \;
</pre>
This is an example to get access rights but it should only used if no other user has access to the installation.
 Alternatively, you can use access groups and putting the users to the group and give only the group write permissions, e.g. 
<pre>
find /etc/webdavcgi/ -name locale -type d -exec chgrp -R mygroup {} \;
find /etc/webdavcgi/ -name help -type d -exec chgrp -R mygroup {} \;
find /etc/webdavcgi/ -name locale -type d -exec chmod -R g+w {} \;
find /etc/webdavcgi/ -name help -type d -exec chmod -R g+w {} \;
</pre>
And to see your results you should delete temporary message files (<code>rm /tmp/*msg</code>) 
and put your language to the %SUPPORTED_LANGUAGES in your webdav.conf (<code>$SUPPORTED_LANGUAGES{_my_locale_} = 'MyLanguage'; </code>)
if necessary (or simply write <code>?lang=_my_locale_</code> behind the WebDAV CGI URL).
</p>
The old and simple way:
<p>Copy the <code>locale/webdav-ui_default.msg</code> to <code>locale/webdav-ui_&lt;_my_locale_&gt;.msg</code> 
and translate all values (leave the keys unchanged; format: <code>key "value"</code>).
</p>
</div>
<div>
<a href="doc-simple-view.html">The Simple view</a> has a lot of extensions with locale files: <code>/etc/webdavcgi/lib/perl/WebInterface/Extensions/*/locale/*</code>. 
</div>
<div>
<strong>And don't forget to sent <a href="mailto:d.rohde@cms.hu-berlin.de?subject=WebDAV%20CGI">me</a> your translation. Thanx :-)</strong>
</div>

<h3>How to change CSS styles</h3>
There are many ways to do it:

<ul>
<li> Add a <code>webdav-ui-custom.css</code> to the <code>lib/</code> directory of the WebDAV CGI installation (recommended). Note: webdav.pl delivers this style file with a cache timeout of one week. 
     You can compress the style sheet to speed up file transfers: (<code>gzip webdav-ui-custom.css</code>). If webdav-ui-custom.css and webdav-ui-custom.css.gz exist then the uncompressed version is delivered.</li>
<li> Add the following to your WebDAV CGI configuration file:
<pre>
$CSS .= &lt;&lt;EOF 

	.filelist { font-size: 0.9em; }

EOF
;
</pre>
</li>
<li> Set <code>$CSSURI</code> variable in your WebDAV CGI config, e.g. <code>$CSSURI='http://myserver/mystyle.css';</code></li>
<li> Set the <code>$HTMLHEAD</code> variable in your WebDAV CGI config (e.g. <code>$HTMLHEAD='&lt;link .../&gt;';</code> or <code>$HTMLHEAD='&lt;style&gt;...&lt;/style&gt;';</code>)</li>
<li> see <a href="doc-simple-view.html#css">Simple view</a> documentation for more.
<li>...</li>
</ul>
<h3>How to add or change icons</h3>

Here are some examples to do that in the WebDAV CGI configuration file:
<ul>
<li><code>$ICONS{'mymime/type'}='/uripath/to/my/icons/test.gif';</code></li>
<li><code>%ICONS = ( %ICONS, ( 'mymime/type1'=&gt;'/uripath/to/my/icons/test1.gif', 'mymime/type2'=&gt;'/uripath/to/my/icons/test2.gif',   ) );</code></li>
</ul>

<h3>How to customize error messages/documents</h3>
<p>
Two HTTP status codes are supported for customized error documents: '<code>404 Not Found</code>' and '<code>403 Forbidden</code>'
</p>
<p>
You have to  use '.html' or '.txt' extensions for your error documents to determine a correct MIME type.
</p>
<ol>
<li> put your error documents to the <code>$INSTALL_BASE/htdocs</code> folder or wherever you want (should be readable by your users)</li>
<li> add following options to your WebDAV CGI configuration file:
<pre>
$ERROR_DOCS{'404 Not Found'} = "$INSTALL_BASE/htdocs/404.html";
$ERROR_DOCS{'403 Forbidden'} = "$INSTALL_BASE/htdocs/403.html";
</pre>
</li>
</ol>

<h3>Variable substitution in $HEADER, $SIGNATURE, $LANGSWITCH, and %ICONS</h3>

Following variables are substituted:
<table>
<tr><td>$CLOCK</td><td>a clock with client time formatted with locale value for key 'vartimeformat'</td></tr>
<tr><td>$ENV{_VAR_}</td><td>value of environment variable _VAR_</td></tr>
<tr><td>$LANG</td><td>current language code</td></tr>
<tr><td>$NOW</td><td>current date formatted with locale value for key 'varnowformat'</td></tr>
<tr><td>$PATH_TRANSLATED</td><td>locale folder name corresponding to the request URI</td></tr>
<tr><td>$REQUEST_URI</td><td>request URI without query string</td></tr>
<tr><td>$TIME</td><td>current time formatted with locale value for key 'vartimeformat'</td></tr>
<tr><td>$TL{_KEY_}</td><td>locale value for key  _KEY_</td></tr>
<tr><td>$USER</td><td>current user id</td></tr>
<tr><td>$VBASE</td><td>virtual host base matching <code>$VIRTUAL_BASE</code></td></tr>
<tr><td>$VHTDOCS</td><td>virtual htdocs path <code>$VHTDOCS</code> to the <code>$INSTALL_BASE/htdocs</code></td></tr>
</table>
<h2 id="performance">Performance</h2>
<ul>
  <li> Use a fast (local) database.</li>
  <li> Don't use mod_auth_external without auth caching. </li>
  <li> Use load balancing cluster (Attention: use a central, single database for all nodes)</li>
  <li> Disable all features you don't need (take a look at all <code>$ALLOW_...</code> and <code>$ENABLE_...</code> parameters in the WebDAV CGI setup section):
  	<ul>
		<li><code>$ENABLE_LOCK = 0;</code> - disable WebDAV locking support but it is unsafe in conjunction with shared group folders and some clients make trouble.</li>
		<li>Web interface:
			<ul>
			<li><code>$ENABLE_THUMBNAIL=0;</code> - disables thumbnail support</li>
			<li><code>$ENABLE_THUMBNAIL_CACHE=1;</code> - enables the thumbnail cache and reduces CPU usage (only useful if <code>$ENABLE_THUMBNAIL=1;</code>)</li>
			<li><code>$ENABLE_THUMBNAIL_PDFPS=0;</code> - disables thumbnails for PDF/PS documents and reduces CPU usage (only useful if <code>$ENABLE_THUMBNAIL=1;</code></li>
			</ul>
		</li>
	</ul>
  </li>
  <li> Compression of HTML, JavaScript, and CSS is enabled by default (<code>$ENABLE_COMPRESSION = 1;</code>) but this option can increase your server load.</li>
  <li> Filter and limit large folders (<code>$FILECOUNTLIMIT</code>, <code>$FILECOUNTPERDIRLIMIT</code>, <code>$FILEFILTERPERDIR</code>)</li>
  <li> Limit folder depth for copy/move operations (<code>$LIMIT_FOLDER_DEPTH</code>)</li>
  <li> Change the bufsize for upload/download operations (<code>$BUFSIZE</code>)</li>
  <li> Since WebDAV CGI v1.0.0 mod_perl is supported for backends without setuid/setgid wrapping (e.g. SMB, AFS)</li>
  <li> disable <code>$CREATE_DB</code> after first WebDAV access (PROPFIND request). If you use a file based database like SQLite you can enable/disable it automatically: <code>$CREATE_DB = !-e &lt;mydatabasefile.db&gt;</code></li>
  <li> Slow response working with WebDAV resources on Windows Vista or Windows 7: <a href="http://support.microsoft.com/kb/2445570">KB2445570</a></li>
  <li> For AFS backend users: 
  	<ul><li>prevent usage of mod_auth_kerberos and mod_waklog</li>
  		<li>replace pagsh with a fast bourne shell (e.g. DASH) in the afswrapper script (<code>cgi-bin/afswrapper</code>)</li>
  	</ul> </li>
  	
</ul>
<h2 id="security">Security</h2>
<h3>HTTP Basic Authentication and Brute Force Attacks </h3>
The WebDAV protocol or most WebDAV clients supports only HTTP Basic authentication so you need it for WebDAV access. 
<ol>
<li>You can use the session.pl script of WebDAV CGI (see <a href="session.html">Session or form-based authentication</a>) 
for your WebDAV access because the session authentication handler of WebDAV CGI has a pure brute force attack detection and prevention (BFAP). 
There are some options you can set in your webdav-session.conf to modify the behavoir of BFAP. The default setting allows only 3 login attempts within 10 seconds for a account:
<pre>
$SESSION{bfap} = {
    # type of BFAP protection for counting login attempts  (0: disabled; 1: by user; 2: by user@IP; 3: by IP):
    # note: if you use NAT or a load balancer the REMOTE_ADDR environment variable is not useable so you should use value "2"
    type => 1,
    # number of allowed login failures before logon will be paused:
    failcount} => 3,
    # time range in seconds before the failcount will be reseted:
    failrange => 10,
    # delay in seconds to be paused after failcount was reached (only effective in session logon screen):
    delay => 10,
    # sleep for some seconds before login attempt (every (successful) logon will be delayed) (0 - disabled)
    sleep => 0,
    # sleep for random seconds before (successul) login attempt (0 - disabled; >0: range of seconds for random routine)
    randomsleep => 0,
};
</pre>  

</li>
<li>Or you can use a authentication module of your webserver. You should use
<ul>
<li>fail2ban </li>
<li>or mod_security (Apache only).</li>
</ul>
</li>
</ol>
<h3>Temporary files and disk/memory space</h3>
WebDAV CGi creates a lot of temporary files:
<ul>
<li> cached files for JavaScript, CSS, localization messages</li>
<li> thumbnails for previes</li>
<li> upload and download files</li>
<li> brute force attack prevention(BFAP) files (webdav_bfap_*)</li>
</ul>
You should setup some monitoring and maintenance scripts to protect your server against running out of memory if temp is a RAM disk or a full (root) harddisk.
It's possible to limit upload/download file sizes, to disable thumbnails, or to setup temporary folder directory.

<div id="contact">
&copy; ZE CMS, Humboldt-Universit&auml;t zu Berlin | Written 2010-2017 by <a href="mailto:d.rohde@cms.hu-berlin.de?subject=WebDAV%20CGI">Daniel Rohde</a> </div>
</div>
</body>
</html>
